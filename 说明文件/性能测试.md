## 测试环境



## 测试内容
* 单线程和多线程不同线程池大小情况下的吞吐量测试
* http短连接和长连接情况测试 

## 衡量标准
* QPS(Queries Per Second): 意思是“每秒查询率”，是一台服务器每秒能够相应的查询次数，是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准。
* TPS(Transactions Per Second): 也就是事务数/秒。一个事务是指一个客户机向服务器发送请求然后服务器做出反应的过程。客户机在发送请求时开始计时，收到服务器响应后结束计时，以此来计算使用的时间和完成的事务个数。
* 主要区别是一个事务可能会对应多个请求，例如对于一个页面的一次访问，形成一个Tps；但一次页面请求，可能产生多次对服务器的请求，即多个QPS
* 并发数： 系统同时处理的request/事务数
* 计算公式
```
    QPS（TPS）= 每秒钟处理的request/事务
    QPS（TPS）= 并发数/平均响应时间 
    并发数 = QPS(TPS)*平均响应时间
```
一个系统吞吐量通常由QPS（TPS）、并发数两个因素决定，每套系统这两个值都有一个相对极限值，在应用场景访问压力下，只要某一项达到系统最高值，系统的吞吐量就上不去了，如果压力继续增大，系统的吞吐量反而会下降，原因是系统超负荷工作，上下文切换、内存等等其它消耗导致系统性能下降。

## 测试方法
* 理想的测试环境是两台计算机，带宽无限。但是现在的CPU运算速度都很快，很容易就把千兆以太网的带宽跑满，导致所有吞吐量测试都是110MiB/s，失去对比意义。所以选择本地环境测试。
* 采用ping pong协议测试吞吐量
>客户端和服务端都实现echo协议，当Tcp连接建立时，客户端向服务端发送一些数据，服务器会echo回这些数据，然后客户端再echo回服务器，不断循环，直到一方断开连接为止。数据是无格式的，收到多少数据就单射回去多少数据。